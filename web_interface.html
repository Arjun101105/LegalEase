<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>LegalEase - Legal Text Simplification</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 20px;
        }

        .container {
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.1);
            padding: 40px;
            max-width: 1200px;
            width: 100%;
            min-height: 600px;
        }

        .header {
            text-align: center;
            margin-bottom: 40px;
        }

        .header h1 {
            color: #333;
            font-size: 2.5em;
            margin-bottom: 10px;
            background: linear-gradient(135deg, #667eea, #764ba2);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .header p {
            color: #666;
            font-size: 1.1em;
        }

        .content {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 30px;
            margin-bottom: 30px;
        }

        .input-section, .output-section {
            display: flex;
            flex-direction: column;
        }

        .section-title {
            font-size: 1.3em;
            color: #333;
            margin-bottom: 15px;
            font-weight: 600;
        }

        .textarea {
            width: 100%;
            height: 300px;
            border: 2px solid #e0e0e0;
            border-radius: 10px;
            padding: 15px;
            font-size: 1em;
            font-family: inherit;
            resize: vertical;
            transition: border-color 0.3s ease;
        }

        .textarea:focus {
            outline: none;
            border-color: #667eea;
        }

        .controls {
            display: flex;
            gap: 15px;
            margin: 20px 0;
            align-items: center;
        }

        .btn {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            border: none;
            padding: 12px 25px;
            border-radius: 25px;
            font-size: 1em;
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: 600;
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.3);
        }

        .btn:disabled {
            background: #ccc;
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
        }

        .checkbox-container {
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .checkbox {
            width: 18px;
            height: 18px;
        }

        .label {
            color: #555;
            font-weight: 500;
        }

        .status {
            padding: 10px 15px;
            border-radius: 8px;
            margin: 10px 0;
            font-weight: 500;
        }

        .status.success {
            background: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }

        .status.error {
            background: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }

        .status.info {
            background: #d1ecf1;
            color: #0c5460;
            border: 1px solid #bee5eb;
        }

        .examples {
            background: #f8f9fa;
            border-radius: 10px;
            padding: 20px;
            margin-top: 20px;
        }

        .examples h3 {
            color: #333;
            margin-bottom: 15px;
        }

        .example-btn {
            background: #6c757d;
            color: white;
            border: none;
            padding: 8px 15px;
            border-radius: 15px;
            margin: 5px;
            cursor: pointer;
            font-size: 0.9em;
        }

        .example-btn:hover {
            background: #5a6268;
        }

        .metrics {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
            gap: 15px;
            margin-top: 20px;
        }

        .metric {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 8px;
            text-align: center;
        }

        .metric-value {
            font-size: 1.5em;
            font-weight: bold;
            color: #667eea;
        }

        .metric-label {
            font-size: 0.9em;
            color: #666;
            margin-top: 5px;
        }

        @media (max-width: 768px) {
            .content {
                grid-template-columns: 1fr;
            }
            
            .container {
                padding: 20px;
            }
            
            .header h1 {
                font-size: 2em;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>‚öñÔ∏è LegalEase</h1>
            <p>Transform complex legal language into simple, understandable English</p>
        </div>

        <div class="content">
            <div class="input-section">
                <div class="section-title">üìù Legal Text Input</div>
                <textarea 
                    id="inputText" 
                    class="textarea" 
                    placeholder="Paste your complex legal text here... For example, 'The plaintiff filed a writ petition under Article 32 of the Constitution seeking enforcement of fundamental rights...'"
                ></textarea>
            </div>

            <div class="output-section">
                <div class="section-title">‚ú® Simplified Output</div>
                <textarea 
                    id="outputText" 
                    class="textarea" 
                    placeholder="Simplified text will appear here..."
                    readonly
                ></textarea>
            </div>
        </div>

        <div class="controls">
            <button id="simplifyBtn" class="btn">üîÑ Simplify Text</button>
            <div class="checkbox-container">
                <input type="checkbox" id="useLLM" class="checkbox" checked>
                <label for="useLLM" class="label">Use Enhanced LLM Processing</label>
            </div>
        </div>

        <div id="status"></div>

        <div class="metrics" id="metrics" style="display: none;">
            <div class="metric">
                <div class="metric-value" id="processingTime">-</div>
                <div class="metric-label">Processing Time (ms)</div>
            </div>
            <div class="metric">
                <div class="metric-value" id="originalLength">-</div>
                <div class="metric-label">Original Length</div>
            </div>
            <div class="metric">
                <div class="metric-value" id="simplifiedLength">-</div>
                <div class="metric-label">Simplified Length</div>
            </div>
            <div class="metric">
                <div class="metric-value" id="compressionRatio">-</div>
                <div class="metric-label">Compression Ratio</div>
            </div>
        </div>

        <div class="examples">
            <h3>üí° Try These Examples:</h3>
            <button class="example-btn" onclick="setExample(1)">Article 32 Petition</button>
            <button class="example-btn" onclick="setExample(2)">Contract Clause</button>
            <button class="example-btn" onclick="setExample(3)">Criminal Procedure</button>
            <button class="example-btn" onclick="setExample(4)">Property Law</button>
            <button class="example-btn" onclick="setExample(5)">Employment Law</button>
        </div>
    </div>

    <script>
        const API_BASE = 'http://localhost:8000';
        
        const examples = {
            1: "The plaintiff filed a writ petition under Article 32 of the Constitution of India seeking enforcement of fundamental rights guaranteed under Articles 14, 19, and 21, alleging violation thereof by the respondent state authorities through arbitrary administrative action.",
            
            2: "Notwithstanding anything contained herein to the contrary, the Party of the First Part hereby covenants and agrees that upon the occurrence of any Event of Default as hereinafter defined, the Party of the Second Part shall have the absolute right to terminate this Agreement forthwith.",
            
            3: "The accused shall be produced before the Magistrate within twenty-four hours of such arrest excluding the time necessary for the journey from the place of arrest to the court of the Magistrate in accordance with the provisions of Section 57 of the Code of Criminal Procedure, 1973.",
            
            4: "The transferor hereby conveys, assigns, and transfers unto the transferee all his right, title, and interest in and to the aforementioned immovable property together with all buildings, structures, improvements, easements, rights, and appurtenances thereunto belonging or in anywise appertaining.",
            
            5: "The employer shall not terminate the services of the employee except for good and sufficient cause after giving the employee a reasonable opportunity of being heard and following the principles of natural justice as enshrined under the Industrial Disputes Act, 1947."
        };

        function setExample(num) {
            document.getElementById('inputText').value = examples[num];
        }

        function showStatus(message, type = 'info') {
            const statusDiv = document.getElementById('status');
            statusDiv.innerHTML = `<div class="status ${type}">${message}</div>`;
            
            if (type === 'success' || type === 'error') {
                setTimeout(() => {
                    statusDiv.innerHTML = '';
                }, 5000);
            }
        }

        function updateMetrics(originalText, simplifiedText, processingTime) {
            const metricsDiv = document.getElementById('metrics');
            const originalLength = originalText.length;
            const simplifiedLength = simplifiedText.length;
            const compressionRatio = ((originalLength - simplifiedLength) / originalLength * 100).toFixed(1);
            
            document.getElementById('processingTime').textContent = processingTime;
            document.getElementById('originalLength').textContent = originalLength;
            document.getElementById('simplifiedLength').textContent = simplifiedLength;
            document.getElementById('compressionRatio').textContent = compressionRatio + '%';
            
            metricsDiv.style.display = 'grid';
        }

        async function simplifyText() {
            const inputText = document.getElementById('inputText').value.trim();
            const useLLM = document.getElementById('useLLM').checked;
            const btn = document.getElementById('simplifyBtn');
            
            if (!inputText) {
                showStatus('‚ùå Please enter some text to simplify!', 'error');
                return;
            }
            
            // Show loading state
            btn.disabled = true;
            btn.textContent = '‚è≥ Processing...';
            showStatus('üîÑ Simplifying text using our trained legal AI model...', 'info');
            
            const startTime = Date.now();
            
            try {
                const response = await fetch(`${API_BASE}/api/simplify-text`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({
                        text: inputText,
                        use_llm: useLLM
                    })
                });
                
                console.log('Response status:', response.status);
                console.log('Response ok:', response.ok);
                
                if (!response.ok) {
                    throw new Error(`HTTP ${response.status}: ${response.statusText}`);
                }
                
                const result = await response.json();
                console.log('API Response:', result);
                
                const processingTime = Date.now() - startTime;
                
                // Check multiple possible success indicators
                if (result.success === true || result.status === 'success') {
                    // Ensure simplified_text exists and is a string
                    const simplifiedText = result.simplified_text || '';
                    console.log('Simplified text length:', simplifiedText.length);
                    console.log('Simplified text preview:', simplifiedText.substring(0, 100));
                    
                    document.getElementById('outputText').value = simplifiedText;
                    showStatus('‚úÖ Text successfully simplified!', 'success');
                    
                    try {
                        updateMetrics(inputText, simplifiedText, processingTime);
                    } catch (metricsError) {
                        console.error('Error updating metrics:', metricsError);
                        // Don't fail the whole operation for metrics issues
                    }
                } else {
                    console.error('API returned unsuccessful response:', result);
                    throw new Error(result.error || result.message || 'Unknown error occurred');
                }
                
            } catch (error) {
                console.error('Full error details:', error);
                console.error('Error stack:', error.stack);
                showStatus(`‚ùå Error: ${error.message}`, 'error');
                document.getElementById('outputText').value = '';
            } finally {
                // Reset button state
                btn.disabled = false;
                btn.textContent = 'üîÑ Simplify Text';
            }
        }

        // Event listeners
        document.getElementById('simplifyBtn').addEventListener('click', simplifyText);
        
        // Allow Enter to trigger simplification (Ctrl+Enter in textarea)
        document.getElementById('inputText').addEventListener('keydown', function(e) {
            if (e.ctrlKey && e.key === 'Enter') {
                simplifyText();
            }
        });

        // Check if API is available on page load
        window.addEventListener('load', async function() {
            try {
                const response = await fetch(`${API_BASE}/health`);
                if (response.ok) {
                    showStatus('üü¢ LegalEase API is running and ready!', 'success');
                } else {
                    throw new Error('API not responding');
                }
            } catch (error) {
                showStatus('üî¥ Backend server not running. Please start the server first.', 'error');
            }
        });
    </script>
</body>
</html>